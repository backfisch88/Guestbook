<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title></title>

<style>
:root{
  /* Dein Farbschema */
  --agave:#2e5d50;
  --gold:#c7a96b;

  /* Status */
  --ok:#22c55e;
  --err:#e54848;

  /* Background */
  --bg1:#e7efe9;
  --bg2:#f4f1ea;

  /* Phone */
  --phone-border:#111;
}

html,body{height:100%;}
body{
  margin:0;
  min-height:101vh;
  display:grid;
  place-items:center;
  overflow:hidden;
  background:
    radial-gradient(900px 520px at 50% 10%, rgba(199,169,107,.16), transparent 60%),
    radial-gradient(820px 520px at 50% 0%, rgba(46,93,80,.14), transparent 62%),
    linear-gradient(180deg,var(--bg1),var(--bg2));
}

.stage{
  width:min(420px,92vw);
  height:min(620px,92vh);
  display:grid;
  place-items:center;
}

/* ===== Phone (schwarzer Rahmen + echtes Glas) ===== */
.phone{
  width:min(270px,66vw);
  aspect-ratio: 10 / 21;
  border-radius: 46px;
  border: 4px solid var(--phone-border);
  position:relative;
  overflow:hidden;
  box-shadow: 0 28px 72px rgba(0,0,0,.18);
}
.phone::before{
  content:"";
  position:absolute; inset:10px;
  border-radius: 40px;
  border:1px solid rgba(255,255,255,.10);
  pointer-events:none;
  z-index:4;
}

/* Glass: sehr transparent, mischt mit Hintergrund */
.glass{
  position:absolute; inset:0;
  background:
    linear-gradient(180deg, rgba(255,255,255,.14), rgba(255,255,255,.06)),
    radial-gradient(240px 320px at 50% 15%, rgba(255,255,255,.38), transparent 72%),
    radial-gradient(260px 420px at 38% 48%, rgba(46,93,80,.10), transparent 75%),
    radial-gradient(260px 420px at 62% 40%, rgba(199,169,107,.10), transparent 75%);
  backdrop-filter: blur(30px) saturate(155%);
  -webkit-backdrop-filter: blur(30px) saturate(155%);
}

/* Dynamic Island */
.island{
  position:absolute;
  top:12px;
  left:50%;
  transform:translateX(-50%);
  width:78px;
  height:18px;
  border-radius:999px;
  background:#000;
  box-shadow: 0 2px 0 rgba(255,255,255,.06) inset;
  z-index:6;
}

/* Center */
.center{
  position:absolute;
  inset:0;
  display:grid;
  place-items:center;
  padding-top: 6px;
  z-index:5;
}

/* ===== WiFi (DEIN SVG) ===== */
.wifiWrap{
  width:min(180px, 54%);
  aspect-ratio: 1 / 1;
  display:grid;
  place-items:center;
  transform: translateY(8px);
  filter: drop-shadow(0 18px 30px rgba(0,0,0,.14));
}
.wifiWrap svg{
  width:100%;
  height:auto;
  display:block;
}

/* Wir färben das SVG über fill auf den Pfaden */
.wifiWrap .wifiPath{
  fill: url(#wifiGrad);
  opacity:.11;
  animation: wifiPulse 2.8s ease-in-out infinite;
}
.wifiWrap .wifiPath.p2{ opacity:.095; animation-delay:.14s; }
.wifiWrap .wifiPath.p3{ opacity:.085; animation-delay:.28s; }

@keyframes wifiPulse{
  0%,100%{ opacity:.075; }
  50%{ opacity:.19; }
}

/* Optional: ganz leichte “Apple”-Schimmerkante */
.wifiWrap .shine{
  fill: rgba(255,255,255,.16);
  opacity:.0;
  animation: shine 4.2s ease-in-out infinite;
  mix-blend-mode: overlay;
}
@keyframes shine{
  0%,100%{ opacity:0; transform: translateY(0); }
  45%{ opacity:.12; transform: translateY(-2px); }
  55%{ opacity:.06; }
}

/* ===== Morph: WiFi zieht zusammen -> X zeichnet ===== */
.phone.morphing .wifiWrap{
  animation: shrink .48s cubic-bezier(.2,.9,.2,1) forwards;
}
@keyframes shrink{
  to{
    transform: translateY(8px) scale(.84);
    opacity:.05;
    filter: blur(1.2px);
  }
}

.result{
  position:absolute;
  inset:0;
  display:grid;
  place-items:center;
  opacity:0;
  transform: translateY(8px) scale(.92);
  transition: opacity .22s ease, transform .22s ease;
  pointer-events:none;
  z-index:7;
}
.result.show{
  opacity:1;
  transform: translateY(8px) scale(1);
}
.result.pop{
  animation: pop .42s cubic-bezier(.2,.9,.2,1);
}
@keyframes pop{
  0%{ transform: translateY(8px) scale(.92); }
  55%{ transform: translateY(8px) scale(1.06); }
  100%{ transform: translateY(8px) scale(1); }
}

.result svg{ width:82px; height:82px; }

.draw{
  fill:none;
  stroke-linecap:round;
  stroke-linejoin:round;
  stroke-width:8;
  stroke-dasharray:160;
  stroke-dashoffset:160;
  animation: drawLine .55s ease forwards;
}
@keyframes drawLine{ to{ stroke-dashoffset:0; } }

/* Phone border states */
.phone.err{ border-color: var(--err); }
.phone.ok{ border-color: var(--ok); }

.phone.err{
  box-shadow: 0 28px 72px rgba(0,0,0,.18), 0 0 28px rgba(229,72,72,.10);
}
.phone.ok{
  box-shadow: 0 28px 72px rgba(0,0,0,.18), 0 0 28px rgba(34,197,94,.10);
}

*{-webkit-tap-highlight-color:transparent; user-select:none;}
</style>
</head>

<body>
<div class="stage">
  <div class="phone" id="phone">
    <div class="glass" aria-hidden="true"></div>
    <div class="island" aria-hidden="true"></div>

    <div class="center">
      <!-- WiFi -->
      <div class="wifiWrap" id="wifiWrap" aria-hidden="true">
        <!-- dein SVG (exakt), nur:
             - viewBox beibehalten
             - fill/stroke im <g> entfernen / überschreiben -> wir nutzen Klassen -->
        <svg xmlns="http://www.w3.org/2000/svg"
             viewBox="0 0 600 455" preserveAspectRatio="xMidYMid meet" aria-hidden="true">
          <defs>
            <linearGradient id="wifiGrad" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#2e5d50"/>
              <stop offset="1" stop-color="#c7a96b"/>
            </linearGradient>
          </defs>

          <!-- NOTE: wir übernehmen exakt deine Pfade.
               Der ursprüngliche <g> hatte fill="#000000".
               Hier setzen wir fill="none" am g und geben jedem path seine Klasse/Fill. -->
          <g transform="translate(0,455) scale(0.1,-0.1)" fill="none" stroke="none">

            <path class="wifiPath p1"
              d="M2950 3999 c-80 -4 -188 -15 -240 -24 -52 -9 -126 -21 -164 -27 -296 -42 -742 -203 -1020 -367 -48 -28 -89 -51 -91 -51 -3 0 -45 -25 -94 -55 -212 -131 -531 -397 -531 -443 0 -25 508 -532 533 -532 10 0 60 37 111 83 50 46 127 111 171 144 80 60 289 188 375 230 128 62 199 92 240 103 25 7 50 15 55 19 30 22 309 93 450 114 212 33 385 41 553 28 442 -36 796 -145 1146 -353 154 -92 248 -159 370 -266 54 -48 107 -93 118 -101 17 -13 38 6 283 250 146 145 265 271 265 280 0 36 -275 272 -470 403 -97 65 -329 197 -417 237 -26 12 -77 35 -112 51 -74 34 -214 89 -286 114 -53 18 -334 91 -400 104 -256 52 -563 73 -845 59z"/>

            <path class="wifiPath p2"
              d="M2980 2890 c-108 -8 -236 -29 -390 -64 -193 -44 -595 -231 -735 -341 -21 -16 -65 -52 -99 -78 -83 -66 -166 -146 -166 -162 0 -12 512 -527 530 -533 5 -2 42 24 82 58 40 34 103 81 139 105 67 45 244 137 289 150 14 4 30 11 35 15 11 9 89 30 205 55 118 26 375 31 485 10 135 -26 245 -54 290 -74 22 -10 63 -29 90 -41 128 -57 266 -147 372 -242 24 -21 48 -38 56 -38 7 0 131 118 275 263 185 186 261 268 257 279 -8 21 -130 129 -230 204 -144 109 -361 226 -560 304 -94 37 -285 88 -370 100 -33 5 -87 13 -120 19 -90 14 -305 20 -435 11z"/>

            <path class="wifiPath p3"
              d="M3040 1784 c-14 -2 -65 -11 -115 -20 -49 -9 -111 -22 -137 -31 -52 -17 -226 -103 -273 -136 -56 -39 -145 -119 -145 -131 0 -13 761 -776 774 -776 18 0 766 755 766 773 0 51 -259 219 -417 270 -118 38 -369 67 -453 51z"/>

            <!-- (Optional) Shine layer: die gleichen Pfade als subtile Lichtkante -->
            <path class="shine"
              d="M2950 3999 c-80 -4 -188 -15 -240 -24 -52 -9 -126 -21 -164 -27 -296 -42 -742 -203 -1020 -367 -48 -28 -89 -51 -91 -51 -3 0 -45 -25 -94 -55 -212 -131 -531 -397 -531 -443 0 -25 508 -532 533 -532 10 0 60 37 111 83 50 46 127 111 171 144 80 60 289 188 375 230 128 62 199 92 240 103 25 7 50 15 55 19 30 22 309 93 450 114 212 33 385 41 553 28 442 -36 796 -145 1146 -353 154 -92 248 -159 370 -266 54 -48 107 -93 118 -101 17 -13 38 6 283 250 146 145 265 271 265 280 0 36 -275 272 -470 403 -97 65 -329 197 -417 237 -26 12 -77 35 -112 51 -74 34 -214 89 -286 114 -53 18 -334 91 -400 104 -256 52 -563 73 -845 59z"/>
          </g>
        </svg>
      </div>

      <!-- Result -->
      <div class="result" id="result" aria-hidden="true">
        <svg viewBox="0 0 100 100">
          <path id="resultPath" class="draw"></path>
        </svg>
      </div>
    </div>
  </div>
</div>

<script>
/* ==========================
   EXTERN ROUTER LOGIC
   ========================== */
const INTERNAL_OK_URL   = "192.168.178.10:8082/vis/guestbook/internal-ok.html";
const EXTERNAL_FALLBACK = "index1.html";

const SEARCH_TIME_MS = 1600;
const TIMEOUT_MS     = 2800;
const SHOW_RESULT_MS = 1000;

// Safari-Bar einklappen
setTimeout(()=>window.scrollTo(0,1),60);

function getTokenSuffix(){
  const url = new URL(window.location.href);
  const q = url.searchParams.get("t");
  if(q) return "?t="+encodeURIComponent(q);

  const h = (url.hash||"").replace(/^#/,"");
  if(!h) return "";
  const hp = new URLSearchParams(h);
  const ht = hp.get("t");
  if(ht) return "#t="+encodeURIComponent(ht);
  return "";
}
const tokenSuffix = getTokenSuffix();

const phone = document.getElementById("phone");
const result = document.getElementById("result");
const resultPath = document.getElementById("resultPath");

let left=false;
window.addEventListener("pagehide",()=>left=true);

// 1) Intern versuchen
setTimeout(()=>{
  window.location.href = INTERNAL_OK_URL + tokenSuffix;
}, SEARCH_TIME_MS);

// 2) Wenn noch hier: WiFi -> X + extern weiter
setTimeout(()=>{
  if(left) return;

  phone.classList.add("err","morphing");

  setTimeout(()=>{
    result.classList.add("show","pop");
    resultPath.setAttribute("stroke","var(--err)");
    resultPath.setAttribute("d","M30 30 L70 70 M70 30 L30 70");
  }, 160);

  setTimeout(()=>{
    window.location.replace(EXTERNAL_FALLBACK + tokenSuffix);
  }, 160 + SHOW_RESULT_MS);

}, TIMEOUT_MS);
</script>
</body>
</html>
